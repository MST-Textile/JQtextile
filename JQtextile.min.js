(function(a){a.fn.JQtextile=function(a){function E(a){if(a){d=0}if(b){e+="</p>"+l;b=0}if(c&&!d){e+="</blockquote>"+l;c=0}}function D(a,b,c){return"<"+a+b+">"+c+"</"+a+">"}function C(a,b){return" "+a+'="'+b+'"'}function B(a){var b="";var c="";if(!a){return""}var d=/\[(\w\w)\]/.exec(a);if(d!=null){c+=C("lang",d[1])}var e=/\((\S+)\)/.exec(a);if(e!=null){a=a.replace(/\((\S+)\)/,"");c+=e[1].replace(/#(.*)$/,' id="$1"').replace(/^(\S+)/,' class="$1"')}var f=/(<>|=|<|>)/.exec(a);if(f){b+="text-align:"+g[f[1]]+";"}var h=/\{(\S+)\}/.exec(a);if(h){b+=h[1];if(!h[1].match(/;$/)){b+=";"}}var i=/(\(+)/.exec(a);if(i){b+="padding-left:"+i[1].length+"em;"}var j=/(\)+)/.exec(a);if(j){b+="padding-right:"+j[1].length+"em;"}if(b){c+=C("style",b)}return c}function A(a,b){var c=b.exec(a);if(c!=null){var d="";var e="";var f=/\((.*)\)$/.exec(c[1]);if(f!=null){d=C("alt",f[1])+C("title",f[1]);c[1]=c[1].replace(/\((.*)\)$/,"")}if(c[1].match(/^[><]/)){e="float:"+(c[1].indexOf(">")==0?"right;":"left;");c[1]=c[1].replace(/^[><]/,"")}var g=/(\(+)/.exec(c[1]);if(g){e+="padding-left:"+g[1].length+"em;"}var h=/(\)+)/.exec(c[1]);if(h){e+="padding-right:"+h[1].length+"em;"}if(e){d+=C("style",e)}var i='<img src="'+c[1]+'"'+d+" />";if(c.length>2){i=D("a",C("href",c[2]),i)}a=a.replace(b,i)}return a}function z(a,b,c,d){while(m=b.exec(a)){var e=B(m[1]);m[1]=m[1].replace(/^[\[\{\(]\S+[\]\}\)]/g,"");m[1]=m[1].replace(/^[<>=()]+/,"");a=a.replace(b,d+D(c,e,m[1]))}return a}function y(a){for(i in h){a=a.replace(new RegExp(i,"g"),h[i])}for(i in k){a=z(a,RegExp("^"+k[i]+"(.+?)"+k[i]),i,"");a=z(a,RegExp(" "+k[i]+"(.+?)"+k[i]),i," ")}a=a.replace(/\[(\d+)\]/g,'<sup><a href="#fn$1">$1</a></sup>');a=a.replace(/([A-Z]+)\((.*?)\)/g,'<acronym title="$2">$1</acronym>');a=a.replace(/\"([^\"]+)\":((http|https|mailto):\S+)/g,'<a href="$2">$1</a>');a=A(a,/!([^!\s]+)!:(\S+)/);a=A(a,/!([^!\s]+)!/);a=a.replace(/"([^\"]+)":(\S+)/g,function(a,b,c){return D("a",C("href",f[c]),b)});a=a.replace(/(=)?"([^\"]+)"/g,function(a,b,c){return b?a:"&#8220;"+c+"&#8221;"});return a}function x(a){var h=a.split(/\r?\n/);e="";b=c=d=0;for(var i=0;i<h.length;i++){if(h[i].indexOf("[")==0){var k=h[i].indexOf("]");f[h[i].substring(1,k)]=h[i].substring(k+1)}}for(i=0;i<h.length;i++){if(h[i].indexOf("[")==0){continue}if(r=s.exec(h[i])){E(1);b=1;e+=h[i].replace(s,"<p"+B(r[1])+">"+y(r[2]));continue}if(r=/^h(\d)(\S*)\.\s*(.*)/.exec(h[i])){E(1);e+=D("h"+r[1],B(r[2]),y(r[3]))+l;continue}if(r=t.exec(h[i])){E(1);b=1;e+=h[i].replace(t,'<p id="fn'+r[1]+'"><sup>'+r[1]+"</sup>"+y(r[2]));continue}if(h[i].indexOf("*")==0){o="<ul>";p="</ul>"}else if(h[i].indexOf("#")==0){o="<ol>";p="</ol>"}else{while(n>0){e+=p;if(n>1){e+="</li>"}else{e+="\n"}e+="\n";n--}o=""}if(o){E(1);var k=/^([*#]+)\s*(.*)/.exec(h[i]);var m=k[1].length;while(m<n){e+=p+"</li>\n";n--}while(n<m){e=e.replace(/<\/li>\n$/,"\n");e+=o;n++}e+=D("li","",y(k[2]))+"\n";continue}if(h[i].match(v)){E(1);q=1;e+=h[i].replace(v,'<table style="$1;">\n');continue}if(h[i].indexOf("|")==0||h[i].match(w)){E(1);if(!q){e+="<table>\n";q=1}var x="";var z="";var A=w.exec(h[i]);if(A){x=C("style",A[1]);h[i]=h[i].replace(w,"|")}var F=h[i].split("|");for(j=1;j<F.length-1;j++){var G="td";if(F[j].indexOf("_.")==0){G="th";F[j]=F[j].substring(2)}F[j]=y(F[j]);var H=/^([<>=^~\/\\\{]+.*?)\.(.*)/.exec(F[j]);var I="",J="";if(H!=null){F[j]=H[2];var K=/\\(\d+)/.exec(H[1]);if(K!=null){I+=C("colspan",K[1])}var L=/\/(\d+)/.exec(H[1]);if(L!=null){I+=C("rowspan",L[1])}var M=/([\^~])/.exec(H[1]);if(M!=null){J+="vertical-align:"+g[M[1]]+";"}var N=/(<>|=|<|>)/.exec(H[1]);if(N!=null){J+="text-align:"+g[N[1]]+";"}var O=/\{([^\}]+)\}/.exec(H[1]);if(O!=null){J+=O[1]}if(J!=""){I+=C("style",J)}}z+=D(G,I,F[j])}e+="\t"+D("tr",x,z)+"\n";continue}if(q){e+="</table>"+l;q=0}if(h[i]==""){E()}else if(!b){if(r=u.exec(h[i])){h[i]=h[i].replace(u,"");e+="<blockquote>";c=1;if(r[1]){d=1}}e+="<p>"+y(h[i]);b=1}else{e+=y(h[i])}}E();return e}var b;var c;var d;var e;var f=new Array;var g={">":"right","<":"left","=":"center","<>":"justify","~":"bottom","^":"top"};var h={"'":"&#8217;"," - ":" &#8211; ","--":"&#8212;"," x ":" &#215; ","\\.\\.\\.":"&#8230;","\\(C\\)":"&#169;","\\(R\\)":"&#174;","\\(TM\\)":"&#8482;"};var k={b:"\\*\\*",i:"__",em:"_",strong:"\\*",cite:"\\?\\?",sup:"\\^",sub:"~",span:"\\%",del:"-",code:"@",ins:"\\+",del:"-"};var l="\n\n";var n=0,o="",p="",q=0,r="";var s=/^p(\S*)\.\s*(.*)/;var t=/^fn(\d+)\.\s*(.*)/;var u=/^bq\.(\.)?\s*/;var v=/^table\s*{(.*)}\..*/;var w=/^\{(\S+)\}\.\s*\|/;this.html(x(a))}})(jQuery)